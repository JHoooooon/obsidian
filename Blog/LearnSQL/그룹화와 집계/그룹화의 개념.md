
---

우수 고객에게 무료 대여 쿠폰을 보내야 한다고 가정하자

```mysql
SELECT customer_id FROM rental;
```

이는 모두 $16,044$ 의 `rental` 데이터셋이 반환된다.
이때, 영화를 가장 많이 대여한 고객을 찾는것은 불가능하다

이때, `group by` 절을 사용해서 데이터를 그룹화할수 있다.

```mysql
SELECT customer_id
FROM rental r
GROUP BY customer_id ;
```

$599$ 개의 데이터로 줄어드는것을 볼수 있다.
앞전의 데이터셋은  $16.044$ 개는 모든 대여 목록을 반환하는 반면, 이번 쿼리는 모든 대여목록중 `customer_id` 를 그룹화한 데이터셋을 반환하기 때문이다.

이로인해 총 `customer_id` 가 총 $599$ 개의 `id` 가 있다는것을 알수도 있다.
이렇게 그룹화 시킨다면 이를 이용해 각 고객의 대여한 영화 수를 확인해 볼 수 있다.

```mysql
SELECT 
	customer_id, 
	count(*) rental_count
FROM rental r
GROUP BY customer_id ;
```

```sh
customer_id|rental_count|
-----------+------------+
          1|          32|
          2|          27|
          3|          26|
          4|          22|
          5|          38|
          6|          28|
          7|          33|
          8|          24|
          9|          23|
...
```

각 `customer_id` 마다 `rental` 한 대여 횟수를 볼수 있다.
여기서 사용된 `count` 함수를 `집계함수` (`aggregate function`) 이라 한다.



