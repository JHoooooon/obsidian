
`GROUP BY` 에서 필터조건을 적용하려면 `HAVING` 절을 사용해야 한다.

```mysql
SELECT 
	fa.actor_id,
	f.rating,
	COUNT(*)
FROM film_actor fa
	INNER JOIN film f
	ON fa.film_id = f.film_id
WHERE f.rating IN ('G', 'PG')
GROUP BY fa.actor_id, f.rating
HAVING COUNT(*) > 9;
```

```sh
actor_id|rating|COUNT(*)|
--------+------+--------+
     137|PG    |      10|
      37|PG    |      12|
     180|PG    |      12|
       7|G     |      10|
      83|G     |      14|
     129|G     |      12|
     111|PG    |      15|
      44|PG    |      12|
      26|PG    |      11|
      92|PG    |      12|
      17|G     |      12|
     158|PG    |      10|
     147|PG    |      10|
      14|G     |      10|
     102|PG    |      11|
     133|PG    |      10|
```


