
다음은 마케팅 부서에서 매월 상위 5명의 고객에게 무료 영화 대여 서비스를 제공하는 예시이다.

그럼 첫번째로 매월 이용고객을 순위로 쿼리한다.

```mysql
SELECT
	customer_id,
	COUNT(*) cnt,
	MONTHNAME (rental_date) mn,
	RANK() OVER (
		PARTITION BY MONTHNAME(rental_date)
		ORDER BY COUNT(*) DESC
	) rnk
FROM rental r
GROUP BY 
	customer_id,
	MONTHNAME(rental_date);
```

```sh

```