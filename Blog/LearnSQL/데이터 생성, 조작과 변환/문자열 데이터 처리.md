
---

문자열 데이터를 처리할때, 문자자료형중 하나를 사용한다

- **CHAR**<br>지정한 크기 보다 문자열이 작으면 나머지 공간을 공백으로 채운다.<br>고정 길이 문자열 자료형이다.<br>`MySQL` 은 `CHAR` 를 최대 `255` 자, 오라클 데이터베이스는 `2000` 자, `SQL` 서버는 `8000` 자 까지 허용한다.

- **varchar**<br>가변 길이 문자열 자료형이다.<br>`MySQL` 은 `varchar` 열에 최대 `65,535` 자를 허용한다.<br>오라클에서는 `varchar2` 로 `4000` 자, `SQL 서버`는 `8000` 자까지 허용한다.

- **text(`MySQL`  및 `SQL 서버`) 또는 `clob`(`오라클`)**<br>매우 큰 가변 길이 문자열을 저장한다. (`책에서는 문서라고 지칭`)<br>`MySQL` 에는 `최대 4기가 바이트` 크기의 문서를 저장하는 다양한 텍스트 자료형(`tinitext`, `text`, `mediumtext`, `longtext`) 가 있다.<br><br>`SQL 서버` 는 `최대 2기가 바이트` 크기의 문서를 저장하는 `text`  자료형이 있으며, `oracle` 은 `최대 128테라 바이트` 크기의 문서를 저장하는 `clob` 자료형이 포함된다.<br>`SQL 서버 2005` 또는 `varchar(max)` 자료형을 포함하는데, 향후 리리즈에서 제거될 `text` 자료형 대신 사용할것을 권장한다. 

## 문자열 생성

```mysql
CREATE TABLE string_tbl
(
char_fld CHAR(30),
vchar_fld VARCHAR(30),
text_fld TEXT
);
```

```mysql
INSERT INTO string_tbl (char_fld, vchar_fld, text_fld)
VALUES (
	'This is varchar data',
	'This is text data'
);
```

문자열 데이터를 테이블에 삽입할때, 문자열 길이가 해당 열의 최대 크기를 초과하면 서버에서 예외가 발생한다.

>[!info] 예외를 발생시키는 대신 문자열을 자동으로 잘라내도록 `MySQL` 및 `SQL Server` 를 설정할 수 있다.
`MySQL 6.0` 이후 기본 모드는 `strict` 모드이다.
문제가 생기면 예외를 발생시키는 모드로, 이전 버전의 서버에서는 문자열을 최대 크기로 자르고 경고만 했다

다음은 `Engine` 이 예외를 발생시키는 **대신 문자열을 자르고 경고를 발생하도록 하려면 `ANSI` 모드를 선택**해야 한다.

```mysql
SELECT @@session.sql_mode;
```

```sh
@@session.sql_mode                        
----------------------------------------------
STRICT_TRANS_TABLES, NO_ENGINE_SUBSTITUTION
```

다음은 `ansi` 모드로 변경한다

```mysql
SET sql_mode='ansi';
```

```sh
@@session.sql_mode                        
------------------------------------------------
REAL_AS_FLOAT,PIPES_AS_CONCAT,ANSI_QUOTES,.....
```

이전에 경고가 발생한부분을 쿼리하려면 다음처럼 할수 있다.

```mysql
SHOW WARNINGS;
```

위의 `ansi` 모드로 인해, `vchar_fld` 열의 문자여 작업시 `30` 문자가 넘어가더라도, `30` 문자만큼 글자가 잘려서 저장되며, 경고가 발생할 뿐이다.

>[!info] 문자열 잘림을 방지하는 가장 좋은 방법은 저장할수 있는 가장 긴 문자열을 처리할수 있을 만큼 충분히 높게 열의 최댓값을 설정하는 것이다.
>
>서버는 문자열을 저장하기에 충분한 공간 할당만 사용하므로, `varchar` 열에 높은 최댓값을 설정한는게 낭비가 아니라는점이다.

### 작은 따옴표 포함

>[!info] 문자열은 `작은 따옴표` 로 구분되므로, `작은 따옴표` 나 `아포스트로피` 를 포함한 문자열을 다룰때 주의해야 한다.

```mysql
UPDATE string_tbl
SET text_fld = 'This string doesn't workd'
```

위는 당연히 안된다.
해당 언어의 `아포스트로피` 를 처리하기 위해 `escape` 해야 한다

>[!info] `아포스트로피` 에 `작은 따옴표`를 추가해서 `escape` 하거나, `Mysql` 혹은 `Oracle` 같은 경우 `\` 으로 `escape` 가능하다.

```mysql
UPDATE string_tbl
SET text_fld = 'This string didn''t work, but it does now'

UPDATE string_tbl
SET text_fld = 'This string didn\'t work, but it does now'
```

이를 위한 `quote` 내장 함수를 제공한다
이는 외부 파일을 읽어서 내용을 저장하는경우 유용하다

```mysql
SELECT quote(text_fld)
FROM string_tbl;
```

### 특수 문자 포함

`char()` 는 `ASCII` 캐릭터셋의 `255` 자 내에서 문자열을 생성할수 있다.

```mysql
SELECT 'abcdefg', 
```


