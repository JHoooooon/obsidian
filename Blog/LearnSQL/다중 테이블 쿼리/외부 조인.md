
`INNER JOIN` 조건이 테이블의 모든 행에서 일치하는 항목을 찾지 못할수도 있다는 점에서 관심을 두어야 한다.<br><br> 이렇게 일치하지 않는 항목을 찾기 위한 `JOIN`   이 `OUTER JOIN` 이다.
다음은 `OUTER JOIN` 을 위한 예이다.

>[!info] `film` 테이블은 `1000` 개, `inventory` 테이블에 등록된 영화는 `958` 개의 행이 존재한다.
>

```mysql
SELECT SUM(t.num) tot_inventory
FROM (
	SELECT 1 num
	FROM inventory i
	GROUP BY i.film_id
) t
```

```sh
tot_inventory|
-------------+
          958|
```

```mysql
SELECT
	COUNT(*) tot_film
FROM film;
```

```sh
tot_film|
--------+
    1000|
```

>[!info] 이는 `inventory` 에 등록되지 않은 `film` 이 있으므로, 개수를 구하려면 `OUTER JOIN` 을 사용해야 한다.

```mysql
SELECT
	f.film_id,
	f.title,
	COUNT(i.inventory_id) num_copies
FROM film f
	LEFT OUTER JOIN inventory i
	ON f.film_id = i.film_id
GROUP BY f.film_id, f.title;
```

```sh
film_id|title                      |num_copies|
-------+---------------------------+----------+
      1|ACADEMY DINOSAUR           |         8|
      2|ACE GOLDFINGER             |         3|
      3|ADAPTATION HOLES           |         4|
      4|AFFAIR PREJUDICE           |         7|
      5|AFRICAN EGG                |         3|
      6|AGENT TRUMAN               |         6|
	  ...
	128|CATCH AMISTAD              |         0|
```

`CATCH AMISTAD` 의 `num_copies` 가 $0$ 인것을 볼 수 있다
이를 통해 현재 `inventory` 에 포함되지 않은 `film` 을 `JOIN` 해서 재고가 없는 `inventory` 를 찾을수 있다.

정말 `NULL` 값인지 확인하기위해 다음처럼 쿼리해본다

```mysql
SELECT
	f.film_id,
	f.title,
	i.inventory_id
FROM film f
	LEFT OUTER JOIN inventory i
	ON f.film_id = i.film_id
WHERE f.film_id BETWEEN 127 AND 128;
```

```sh
127|CAT CONEHEADS    |         583|
127|CAT CONEHEADS    |         584|
127|CAT CONEHEADS    |         585|
127|CAT CONEHEADS    |         586|
127|CAT CONEHEADS    |         587|
128|CATCH AMISTAD    |        NULL|
```

`NULl` 값으로 확인할수 있다.

## 왼쪽 VS 오른쪽 외부 조인

>[!info] 외부조인은 `LEFT` 키워드와 `RIGHT` 키워드가 존재한다.
<br>**`LEFT` 는 왼쪽의 테이블이 결과셋의 행 수를 결정하며, `RIGHT` 는 오른쪽의 테이블의 결과셋의 행수를 결정한다.**

```sql
SELECT
	f.film_id,
	f.title,
	i.inventory_id
FROM film f
	RIGHT OUTER JOIN inventory i
ON f.film_id = i.film_id
WHERE f.film_id BETWEEN 127 AND 128;
```

```sh
film_id|title        |inventory_id|
-------+-------------+------------+
    127|CAT CONEHEADS|         580|
    127|CAT CONEHEADS|         581|
    127|CAT CONEHEADS|         582|
    127|CAT CONEHEADS|         583|
    127|CAT CONEHEADS|         584|
    127|CAT CONEHEADS|         585|
    127|CAT CONEHEADS|         586|
    127|CAT CONEHEADS|         587|
```

앞전의 쿼리에서 `LEFT`  대신 `RIGHT` 로 작성한다.
그러니 오른쪽 테이블이 결과셋의 행 수를 결정한다.

앞에서 말했듯, `inventory` 테이블의 총 행수는 $958$ 개이므로, 해당 행수에 맞게 처리된다.
즉, `film` 테이블의 `NULL` 값은 포함되지 않는다.

다음처럼 정리할수 있다.

- `A` LEFT OUTER JOIN `B`: `A` 의 모든행과 `B` 의 추가적인 열을 함께 가져오고 싶을때
- `A` RIGHT OUTER JOIN `B`: `B` 의 모든행과 `A` 의 추가적인 열을 함께 가져오고 싶을때 

>[!info] 오른쪽 외부 조인은 거의 발생하지 않으며, 모든 데이터베이스 서버에서 해당 조인을 지원하지 않으므로 항상 왼쪽 조인을 사용하는것이 좋다고 한다.

### 3 방향 외부 조인

경우에 따라서 한 테이블을 다른 두테이블과 외부 조인할수 있다.
이러한 조인을 `3방향 외부 조인`(`3 way outer join`)  이라 한다.

```mysql
SELECT
	f.film_id,
	f.title,
	i.inventory_id,
	r.rental_date
FROM film f
	LEFT OUTER JOIN inventory i
	ON f.film_id = i.film_id
	LEFT OUTER JOIN rental r
	ON i.inventory_id = r.inventory_id
WHERE f.film_id BETWEEN 13 AND 15;
```

```sh
film_id|title         |inventory_id|rental_date        |
-------+--------------+------------+-------------------+
     13|ALI FOREVER   |          67|2005-07-31 18:11:17|
     13|ALI FOREVER   |          67|2005-08-22 21:59:29|
     13|ALI FOREVER   |          68|2005-07-28 15:26:20|
     13|ALI FOREVER   |          68|2005-08-23 05:02:31|
     13|ALI FOREVER   |          69|2005-08-01 23:36:10|
     13|ALI FOREVER   |          69|2005-08-22 02:12:44|
     13|ALI FOREVER   |          70|2005-07-12 10:51:09|
     13|ALI FOREVER   |          70|2005-07-29 01:29:51|
     13|ALI FOREVER   |          70|2006-02-14 15:16:03|
     14|ALICE FANTASIA|            |                   |
     15|ALIEN CENTER  |          71|2005-05-28 02:06:37|
     15|ALIEN CENTER  |          71|2005-06-17 16:40:03|
     15|ALIEN CENTER  |          71|2005-07-11 05:47:08|
     15|ALIEN CENTER  |          71|2005-08-02 13:58:55|
     15|ALIEN CENTER  |          71|2005-08-23 05:13:09|
     15|ALIEN CENTER  |          72|2005-05-27 22:49:27|
     15|ALIEN CENTER  |          72|2005-06-19 13:29:28|
     15|ALIEN CENTER  |          72|2005-07-07 23:05:53|
     15|ALIEN CENTER  |          72|2005-08-01 05:55:13|
     15|ALIEN CENTER  |          72|2005-08-20 15:11:48|
     15|ALIEN CENTER  |          73|2005-07-06 15:51:58|
     15|ALIEN CENTER  |          73|2005-07-30 14:48:24|
     15|ALIEN CENTER  |          73|2005-08-20 22:32:11|
     15|ALIEN CENTER  |          74|2005-07-27 00:15:18|
     15|ALIEN CENTER  |          74|2005-08-23 19:21:22|
     15|ALIEN CENTER  |          75|2005-07-09 02:58:41|
     15|ALIEN CENTER  |          75|2005-07-29 23:52:01|
     15|ALIEN CENTER  |          75|2005-08-18 21:55:01|
     15|ALIEN CENTER  |          76|2005-06-15 08:01:29|
     15|ALIEN CENTER  |          76|2005-07-07 18:31:50|
     15|ALIEN CENTER  |          76|2005-08-01 01:49:36|
     15|ALIEN CENTER  |          76|2005-08-17 07:26:47|
```

`ALICE FANTASIA` 는 `film` 테이블에는 있지만, `inventory` 테이블에 없으며, `rental` 테이블에도 존재하지 않는다.
그러므로, `NULL` 이다.



