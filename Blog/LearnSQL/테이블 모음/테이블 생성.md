
---

`MySql` 데이터베이스에 저장할수 있는 자료형을 파악했다.
`Table` 정의에서 이들을 사용해보자

한 사람을 묘사할 정보의 종류를 떠올려보자

- 이름 name
- 눈동자 색 eye_color
- 생일 birth_date
- 주소 address
- 좋아하는 음식 favorit_foods

이를 `Table` 로 만들면 다음과 같을 것이다.

| 열             | 자료형          | 허용값      |
| :------------ | ------------ | -------- |
| name          | varchar(10)  |          |
| eye_color     | char(2)      | BL,BR,GR |
| birth_date    | date         |          |
| address       | varchar(100) |          |
| favorit_foods | varchar(200) |          |

`Person` 테이블은 다음은 다음과 같은 문제가 있다.

- name 은 성과 이름으로 구분된다
- 여러 사람이 동일한 이름, 눈동자 색, 생년월일 등을 가질수 있으므로, 고유한 식별자가 필요하다
- address 는 거리, 도시, 주/도, 국가 및 우편번호로 구성된 복합 객체이다
- favorit_foods 열일 0 개 또는 1개 이상의 독립적인 항목을 포함하는 목록(`Enumeration`) 이다<br>이는 특정 음식이 `Person` 에 종속될수 있도록 별도의 테이블을 구성하는것이 좋다. (`one to Many`)


다음처럼 구성될수 있다.

| 열           | 자료형                | 허용값        |
| :---------- | ------------------ | ---------- |
| person_id   | smallint(unsigned) |            |
| first_name  | varcher(20)        |            |
| last_name   | varchar(20)        |            |
| eye_color   | char(2)            | BR, BL, GR |
| birth_date  | date               |            |
| street      | varchar(30)        |            |
| city        | varchr(20)         |            |
| state       | varchr(20)         |            |
| country     | varchr(20)         |            |
| postal_code | varchar(20)<br>    |            |

다음은 `Favorit_food` 테이블이다

| 열         | 자료형                | 허용값 |
| :-------- | ------------------ | --- |
| person_id | smallint(unsigned) |     |
| food      | varchar(20)<br>    |     |

여기서는 `One To Many` 로 `Favorit_food` 에서는 고유한 키로써 두 `person_id` 와 `food` 값으로 지정하면 된다.

이렇게 만든 테이블을 스키마를 사용해서 생성한다

```mysql
create table person 
(
	person_id smallint unsigned,
	first_name varchar(20),
	last_name varchar(20),
	eye_color char(2) check (eye_color in ('BR', 'BL', 'GR')),
	birth_date date,
	street varchar(30),
	city varchar(30),
	state varchar(20),
	country varchar(20),
	postal_code varchar(20)
	constraint pk_person primary key (person_id)
);
```

`constraint` 을 사용하여 `primary key` 제약조건을 생성했다.
`person_id` 는 `primary key` 로써 고유한 값이 된다

`eye_color` 는 `BR`, `BL`, `GR` 중 하나의 `color` 이어야 하므로, `check` 제약조건을 사용했다

>[!warning] `MYSQL` 서버는 `check` 제약조건을 정의할수는 있어도 강제하지 않는다.<br>그러므로, `check` 제약조건을 자료형 정의에 병합하는 `enum` 이라는 또다른 문자 자료형을 제공한다.

즉 다음처럼 고쳐사용해야 한다.

```mysql
create table person 
(
	...
	eye_color char(2) enum('BR', 'BL', 'GR'),
	...
);
```

이렇게 한후 생성된 테이블을 보려면 `desc` 명령어를 사용하여 쿼리한다

```mysql
desc person;

Field      |Type                |Null|Key|Default|Extra|
-----------+--------------------+----+---+-------+-----+
person_id  |smallint unsigned   |NO  |PRI|       |     |
first_name |varchar(20)         |YES |   |       |     |
last_name  |varchar(20)         |YES |   |       |     |
eye_color  |enum('BR','BL','GR')|YES |   |       |     |
birth_date |date                |YES |   |       |     |
street     |varchar(30)         |YES |   |       |     |
city       |varchar(30)         |YES |   |       |     |
state      |varchar(20)         |YES |   |       |     |
country    |varchar(20)         |YES |   |       |     |
postal_code|varchar(20)         |YES |   |       |     |
```

위는 다음의 테이블 내용과 같다

| Field | Type  | Null   | Key              | Default | Extra   |
| :---- | ----- | ------ | ---------------- | ------- | ------- |
| 필드명   | 필드 타입 | 생략가능한지 | 기본 키 및 외래 키 포함여부 | 생략시 기본값 | 적용가능 정보 |
>[!info] NULL
>
> **Null 은 값을 제공할수 없는 경우에 사용된다.**
> 이는 다음과 같다
>
> **1. 해당사항 없음**
> **2. 알수없음**
> **3. 비어있는 셋**
>
>즉 값 비교가 불가능하며 `NULL` 인지 확인하려면 `is not null` 혹은 `is null` 을 사용해야 한다.


```mysql
create table favorit_food
(
	person_id smallint unsigned,
	food varchar(20),
	constraint pk_favorit_food primary key (person_id, food),
	constraint fk_fav_food_person_id foreign key (person_id) references person (person_id)
)
```

위의 구문을 사용해 `Foreign key` 제약조건을 생성했다. 
이는 `person` 의 `person_id` 를 `favorit_food` 에서 `person_id` 로써 사용한다는것이다.
또한 `primary key` 를 `food`, `person_id` 로 지정하여 고유한 값으로 쿼리 가능하게 만들었다.

```mysql
desc favorit_food;

Field    |Type             |Null|Key|Default|Extra|
---------+-----------------+----+---+-------+-----+
person_id|smallint unsigned|NO  |PRI|       |     |
food     |varchar(20)      |NO  |PRI|       |     |
```

제대로 생성된것을 볼 수 있다.
