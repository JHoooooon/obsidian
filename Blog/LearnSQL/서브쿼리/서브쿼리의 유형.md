
서브쿼리에서 반환된 결과 셋의 유형은 다음과 같다

- **단일 열을 가진 단일 행**
- **단일 열을 가진 다중 행**
- **다중 열을 가진 다중 행**

언급한 차이점과 더불어 서브쿼리를 구별할 수 있는 다른 기능들을 쓸수 있다.

- **비상관 서브쿼리**(`noncorrelated subqueries`):  완전히 독립적으로 실행하는 서브쿼리
- **상관 서브쿼리**(`correlated subquery`):  포함 구문의 열을 참조하는 서브쿼리

이러한 유형의 서브쿼리를 알아본다

## 비상관 서브쿼리

단독으로 실행될수 있으며 포함 구문에서 아무것도 참조 하지 않는다
`UPDATE` 혹은 `DELETE` 를 사용하지 않는한, 이러한 유형의 서브쿼리를 가장 많이 사용한다. 

### 단일 열을 가진 단일 행을 반환하는 서브쿼리

**단일 행과 단일 열**이 포함된 결과셋을 반환하는 쿼리를 **스칼라 서브쿼리(`scalar subquery`)** 라고 한다.
이러한 유형의 서브쿼리는 일반적인 연산자($=$, $>$, $<$, $<=$, $>=$, $<>$, $!=$) 을 사용하여 조건의 양쪽에 기술할 수 있다

```mysql
SELECT
	city_id,
	city
FROM city
WHERE country_id <> (
	SELECT
		country_id
	FROM country
	WHERE country = 'India'
);
```

```sh
city_id|city                      |
-------+--------------------------+
    251|Kabul                     |
     59|Batna                     |
     63|Béchar                    |
    483|Skikda                    |
    516|Tafuna                    |
     67|Benguela                  |
    360|Namibe                    |
	...
```

위는 `India` 의 `country_id` 를 서브쿼리하고, `India` `country_id` 가 아닌 모든 `city` 를 쿼리한다.
동등조건에서 서브쿼리를 사용했을때 서브쿼리가 둘 이상의 행을 반환하면 오류가 발생한다.

```mysql
SELECT
	city_id,
	city
FROM city
WHERE country_id <> (
	SELECT
		country_id,
		country
	FROM country
	WHERE country = 'India'
);
```

```sh
SQL Error [1241] [21000]: Operand should contain 1 column(s)
```

>[!warning] `피연산자` 는 하나의 `column` 만 포함해야 한다고 경고한다.


### 단일 열을 가진 다중 행을 반환하는 서브쿼리

서브쿼리가 두개 이상의 행을 반환할 경우, 동등조건을 사용할수 없다
대신 이런 유형의 서브쿼리와 함께 조건을 작성할 수 있는 $4$개의 추가 연산자가 있다

#### IN 연산자, NOT IN 연산자

단일 열을 가진 다중 행을 반환하는 서브쿼리는 하나의 집합의 개념으로 볼수 있다
다음은 단일 열을 가진 다중 행을 반환하는 쿼리이다

```mysql
SELECT country_id
FROM country
WHERE country = 'Canada' OR country = 'Mexico';
```

```sh
country_id|
----------+
        20|
        60|
```

이 쿼리는 `country_id` 가 $20$, $60$ 의 값을 가진 집합으로 볼 수 있다
이제 이 쿼리를 서브쿼리로 사용할것이다.




