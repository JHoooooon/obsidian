
`background` 동기화의 본질은 `page context` 에서 이루어지는 작업을 `background` 로 옮기는것이다.

`background` 에서 작업을 처리하면, 쉽게 휘발되는 `webpage` 의 특성에서 벗어날수 있다.
>[!info] `server` 가 `down` 되었거나, `webpage` 는 언제든 닫힐수 있다.

이러한 환경에서 사용자 기기에 `brower` 가 설치되어 있는 한 `background sync` 는 성공적으로 완료될때까지 사라지지 않는다.

이는 `page` 가 닫혀도, 계속 진행되어야 하는 작업을 `background` 에 동기화사용할수 있도록 제공한다.

>[!info] 캘린더에 이벤트를 추가하거나, 해야할일 목록 중 하나를 완료 표시하는 작업들의 완료를 보장한다.

이러한 방식은 간단하게 구현된다.
이는 `page` 에서 `Ajax`  호출같은 작업을 수행하는 대신 동기화 이벤트를 등록하면 된다.

```js
navigator.serviceWorker.ready.then((registration) => {
	registration.sync.register("send-messages");
})
```

이는 활성화된 `service worker` 의 등록 객체를 받아와 `"send-messages"` 라는 동기화 이벤트를 등록한다. 

다음은, `service worker` 에 `sync` 이벤트 리스너를 추가하며, 이를 통해 동기화 이벤트를 수신한다.

```js
self.addEventListener("sync", (event) => {
	if (event.tag === "send-message") {
		// resolve 될때까지 실행
		// waitUntil 은 이벤트 종료를 요청하기전가지, 이벤트를 유지해준다.
		event.waitUntil(() => {
			const send = sendMessages();
			if (send) {
				// 성공 
				return Promise.resolve();
			} else {
				// 실패
				// 실패시, taskqueue 에 들어가 다시 비동기로써 실행
				return Promise.reject();
			}
		})
	}	
});
```

