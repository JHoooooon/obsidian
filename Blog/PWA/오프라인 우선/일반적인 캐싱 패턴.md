
`caching` 에 대한 일반적인 `design pattern` 을 사용한다.
대부분의 `app` 은 각각 다른 몇 가지 `pattern` 을 사용한다.
다음은 날씨 `app` 의 경우이다.

- 날씨 `app` 은 최신 날짜 데이터를 항상 로드하는 패턴을 채택하며,<br>네트워크 요청에 실패하는 경우에만 `cache` 로 부터 데이터를 한다.

- 날씨 `app` 의 날시를 보여주는 `icon` 의 경우, 항상 `cache` 에서 `icon` 을 가져오고 이를 `cache` 에서 찾을수 없을 경우, `network` 요청을 시도한다.

이렇게, 각각의 상황에 따라 `cache` 하는 전략도 변경되어야 한다.
이러한 부분역시 `pattern` 화 된 부분이 있으며, 이러한 `caching pattern` 을 살펴보도록 한다.

## Cache only (캐시만 사용)

`resource` 요청을 `cache` 를 통해 처리한다.
`cache` 에서 응답을 찾을 수 없는 경우 `request` 는 실패한다.

이는 `service worker` 가 설치되는 동안 `web app` 작동에 필요한 모든 `resource` 가 이미 `caching` 한 것으로 가정한다.

이 전략은 `logo`, `icon`, `stylesheet` 같은 `static resource` 를 처리하는데 유용하다.

이러한 `static resource` 는 절대 `resource` 를 바꿀수 없다는 의미는 아니며, 하나의 `app version` 내에서 `activated` 동안 변하지 않음을 의미한다.

만약, `resource` 내용을 변경한다면, 배포시에 `resource` 의 파일이름을 변경하고, `cache` 만료 날짜를 아주 길게 혹은 무기한으로 서버를 설정하는 방법과 비슷하다.

다음은, `service worker` 가 `activated` 되면, 필요한 파일을 다시 가져와 `cache` 에 저장할 수 있다.

```js
self.addEventListener("fetch", (event) => {
	event.respondWith(
		caches.match(event.request)
	);
});
```

## Cache, falling back to network (캐시, 실패하는 경우 네트워크)

이는 [[#Cache only (캐시만 사용)]] 와 비슷하지만, `Cache` 가 없다면, `Content` 를 `Network` 에 요청한다. 

```js
self.addEventListener("fetch", (event) => {
	event.respondWith(
		caches.match(event.request).then((res) => {
			return res || fetch(event.request);
		})
	);
});
```

## Network only (네트워크만 사용)

웹의 전통적인 모델로써, 모든 `resource` 를 `network` 에서 가져온다.
`network` 요청이 실패하면, 전체 요청이 실패한다.

이는 `cache` 를 활용할 필요가 없는 `request` 를 처리하는데 유용하다.

>[!info] 예: `analystics pings` 

`fetch` 이벤트를 별도로 처리하지 않으면, `Network Only` 패턴이 적용된다.

```js
self.addEventListener("fetch", (event) => {
	event.respondWith(
		fetch(event.request)
	);
});
```

## Network, falling back of cache (네트워크, 실패하는 경우 cache)

`Network` 로 요청을 전달하며, `Network` 요청이 실패하면, `cache` 로 부터 `response` 를 찾는다.
`Cache` 에서 찾을수 없다면 `request` 는 실패한다.

```js
self.addEventListener("fetch", (event) => {
	event.respondWith(
		fetch(event.request).catch(() => {
			return caches.match(event.request);
		})
	);
});
```

이는 항상 최신의 컨텐츠를 내려받지만, `Network` 에 연결되지 않는 경우, 기존의 `cache` 를 반환한다.



