
---

[[라우팅 테이블의 우선순위를 결정하는 Longest Prefix Match]] 를 보면 중복된 IP 범위를 가진다면, 더 구체적인 IP 범위를 가진 IP 가 우선순위를 가지는것을 볼 수 있다

>[!warning] 2021.9 월 이후로, 로컬 라우팅에서도 Longest Prefix Match 기법이 적용된다
> 이전에는 로컬 라우팅에 더 구체적인 같은 IP 범위를 등록하면 Error 가 발생했지만 현재로는 구체적인 IP 범위를 가진 주소가 우선순위를 가진다고 책에서 설명한다.

단, 다음의 조건을 만족해야 한다

1. **라우팅 타깃에는 인스턴스와 ENI 만 지정할 수 있다.**
	인스턴스 생성시 ENI 가 자동으로 생성되어 부착되므로, ENI 라고봐도 무방하다

2. **라우팅 대상에는 VPC 의 서브넷 CIDR 만 지정할수 있다.**

East-West 트래픽이란 수평으로 흐르는 트래픽이다

>[!info] 동쪽에서 서쪽으로 흐르니 수평이다.

이는 **VPC 내부의 인스턴스간 통신**이나, **Transit Gateway, Direct Connect 등을 이용한 하이브리드 네트워킹**도 **East-West 트래픽**으로 볼 수 있다

**이는 VPC CIDR 보다 구체화된 라우팅 적용을 할수 있게 되면서 East-West 트래픽 검사가 가능해졌다고 한다.**


**다음은 East-West 트래픽 라우팅의 예시이다.**

![[East-West 검사.png]]

보면 92.75.1.0/24 서브넷이 92.76.100.0/24 범위에 트래픽을 보낼때 Appliance Subnet 의 ENI 로 토래픽 Target 으로 설정되있다

이는 92.75.100.0/24 의 서브넷 역시 92.75.1.0/24 서브넷에 트래픽을 보낸다면, Appliance Subnet 의 ENI 로 트래픽 Target 이 된것을 볼 수 있다

즉, Subnet-1 과 Subnet-2 가 통신하기 위해서는 eni-1* 으로 트래픽을 전달하여 경유하도록 설계된 구조이다.

>[!info]
>**이는 Appliance Subnet 에 보안 어플라이언스나 모니터링 솔류션을 설치하면 트래픽이 최종 목적지에 도달하기전 미리 검사를 받고 반드시 필요한 패칫만 중요 인스턴스로 전달하게 된다고 말한다**
