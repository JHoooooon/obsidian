
---

> [!info]
> **경로 제어** 는 트래픽이 가는 방향을 안내하는 이정표이다.
따라서 트래픽 경로에 이정표가 없으면 트래픽은 소멸된다.
>
이는 지극히 수동적인 트래픽은 능동적으로 목적지로 향해 가는것이 아니며 트래픽 경로에 존재하는 이정표가 끌어 준다고 표현하는 편이 맞다.

## 라우팅이란?

>[!info] 여행자의 목적지는 정해져있다.
>항상 여행자는 **출발지**와 **목적지**를 정하고 출발한다.
>
>여행자는 자신의 목적지에 맞게 찾아간다. 목적지에 맞는 이정표를 보고 선택해서 이 방향이 목적지로 가는구나! 라는것을 안다.
>
>여기서 **출발지**에서 **목적지**로 가는 **여행자는 트래픽** 이고, **이정표** 는 **라우팅**이라 볼수 있다.

아래는 라우팅을 사용하여 출발지에서 목적지로 가는 흐름이다.

![[트래픽 라우팅 경로]]

>[!info]
>AWS 에서 목적지를 **대상** **Destination** 이라 하며 방향을 **Target** 또는 **Gateway** 라 한다. **Next Hop** 으로 쓸때도 있다.
>
> 대상과 타깃으로 구성된 대상과 타깃으로 구성된 이 라우팅은 **라우팅 테이블** 에 쌓여 트래픽에게 경로를 안내한다.

>[!warning]
>우리나라에서는 **Target** 과 **Destination** 모두 대상으로 해석된다.
>이로인해 한글로 번역시 모두 대상으로 나오게 되므로, 이를 주의해서 작업해야 한다.

**라우팅 테이블**은 단순히 **Destination** 과 **Target** 을 지정해놓은 나열이며, 이를 사용하여 **Destination** 으로 가기 위해 **Target** 으로 트래픽을 보낸다.

이러한 나열들을 하나씩 보고 Target 이 자신의 목적지와 일치하거나 목적지를 포함한 Target 이 안내하는 방향으로 이동한다

이는 다음과 같은 내용과 비슷하게 만들어진다.

#### 라우팅 테이블 표

| 목적지 대상(Destination)            | 타깃(Target) |
| :----------------------------- | ---------- |
| 목적지가 13.246.100.0/24 범위에 있으면,  | B 로 이동     |
| 목적지가 122.245.192.0/24 범위에 있으면, | B 로 이동     |
| 목적지가 92.48.24.0/24 범위에 있으면,    | C 로 이동     |


> [!info]
> **자신이 원하는 목적지에 도달하지 못하면 트래픽은 소멸된다.**

### 반환 트래픽 라우팅

요청에는 응답이 수반되어야 한다.
트래픽이 목적지에 도착하면 응답이 있어야 통신이다.

이렇게 트래픽은 **요청 트래픽** 이 있으면 **응답 트래픽** 혹은 **반환 트래픽** 이 존재한다.
이는 위의 [[#라우팅 테이블 표]] 처럼 만들어지며, **서버로 부터 가는 응답 트래픽이므로, 목적지 대상이 Client 가 된다.**

### On-link 라우팅

로컬 통신일 경우, 내부망에서 통신하므로 같은 IP 대역이면 서로 통신이 가능하다.
이는 라우팅 없이도 서로 접속가능하다는 이야기이다.

>[!info] PC에 IP 를 할당하는 과정
>1. CIDR 범위 내 미사용 IP 를 찾아서 PC 의 IP 를 지정한다.
>> - IP주소: 92.75.100.128 | 서브넷 마스크: 255.255.255.0
>
>2. 이렇게 등록된 IP 를 라우팅으로 자동 생성한다.
>
>여기서 알아야할점은, **명시적으로 라우팅을 등록하지 않았을뿐이지,** **CIDR 라우팅을 통해 CIDR 맴버를 자동등록한다는점이다.**

이말은 IP주소, 서브넷 마스크를 등록하는 과정 자체가 라우팅을 등록하는 하나의 과정인것이다.
책에서는 window 를 기반으로 해서 라우팅 개념을 설명하는데, ubuntu 에서는 **link** 로 나타난다.

대략 이러한 모습이다.

```sh
3: wlp2s0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default qlen 1000
    link/ether 9c:b6:d0:61:96:5b brd ff:ff:ff:ff:ff:ff
    inet 172.30.1.100/24 brd 172.30.1.255 scope global dynamic noprefixroute wlp2s0
       valid_lft 2939sec preferred_lft 2939sec
    inet6 fe80::eb38:a46b:7ffd:876c/64 scope link noprefixroute 
       valid_lft forever preferred_lft forever
```

아무래도 linux 가 더 많은 설명을 해주고 있는듯 한데, 이부분은 좀더 훑어 보아야 겠다.
일단 책에서의 **On-link** 는 **네트워크 범위에 해당하는 IP 라면 Network Interface 로 연결해주는 Gateway 를 뜻한다.**

>[!info]
>**이처럼 라우팅이 가능한 모든 장치는 On-link 라우팅에 저장돼 있다.**

이를 모두 정리하면 다음과 같은 구조를 띈다.

![[라우팅 장치에 연결된 모든 인터페이스]]

