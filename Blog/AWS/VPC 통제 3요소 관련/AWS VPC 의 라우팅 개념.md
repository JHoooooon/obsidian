
---
## VPC 의 라우팅

> [!info]
> 지금까지 온프레미스 환경으로써 라우팅 개념을 설명했다.
> 라우팅은 네트워킹의 핵심이므로 어느 영역보다 서론이 길었다고 한다.
> 
> AWS 서비스 중심의 라우팅은 약간 다르다.
> VPC 의 모체는 온프레미스이므로, 라우팅 개념을 익히기에 매우 좋다.

[[온프래미스의 라우팅 개념]] 을 통해 온프레미스 라우팅이 어떻게 이루어지는지 개념을 볼수 있다.

책에서의 VPC 라우팅의 특징은 다음과 같이 설명한다.

1. **라우팅 기본 개념은 온프레미스와 같다**
2. **VPC 라우팅은 라우팅 테이블로 관리한다**
3. **라우팅 테이블은 서브넷 단위로 사용한다. 즉, 서브넷에 연결해 사용한다.**
4. **네트워크 경로상에 존재하는 장치는 확인할수 없을 뿐더러 그 라우팅은 신경쓰지 않아도 된다.**
5. **인스턴스나 서비스 내부에 라우팅 설정을 하지 않는다. 서비스가 놓인 서브넷의 라우팅이 곧 서비스의 라우팅이다.**
6. **VPC 환경의 On-link 는 Local 로 표기하며, 로컬 라우팅이라 한다. 로컬 라우팅 대상은 VPC CIDR 이다.**

| 라우팅 환경        | VPC     | 온프레미스                   |
| :------------ | :------ | ----------------------- |
| 라우팅 관리        | 라우팅 테이블 | 라우팅 테이블                 |
| 라우팅 테이블 연결 대상 | 서브넷     | 경로상의 모든 라우팅 장치          |
| 중간 경로 라우팅     | 설정 불필요  | 장치별 설정 필요               |
| On-link 라우팅   | 로컬 라우팅  | On-link 라우팅             |
| On-link 단위    | VPC     | 라우팅 장치에 연결된 인터페이스의 CIDR |

>[!warning]
>PC 와 서버는 인스턴스로, 소규모 네트워크는 서브넷을 대체한다. 접근 제어(NACL, SG) 는 필요한 규칙만 허용된 것으로 가정하고 생략한다.

![[VPC 환경 구성과 라우팅 테이블]]

VPC 토폴로지에서 Router 는 가상 라우팅 장치이며, 라우팅 테이블 설정이 반영된다.
서브넷은 전부 Routing Table 에 연결되어 있다.

**Local 라우팅 대상은 VPC 의 CIDR 블록이며, VPC-1 의 3개 서브넷은 Local 라우팅만으로 서로 접속가능하다.**

### 게이트웨이

>  **모든 인페이스는 트래픽이 다음 네트워크로 이동할때 두드리는 문이다.
>  이것을 게이트웨이라고 한다.**
>  
>  AWS 에서는 이러한 게이트웨이를 칭할때 **Target 또는 Gateway** 라 부른다

라우팅 편집에서 대상설정시 나오는 VPC 게이트웨이 종류는 다음과 같다
#### VPC 게이트웨이 종류

| VPC 게이트웨이                                                                        | 비고                  |
| :------------------------------------------------------------------------------- | ------------------- |
| Carrier Gateway [[인터넷 게이트웨이(IGW) 와 NAT Gateway]]                                     | Wavelength Zone 연결용 |
| Egress Only Internet Gateway (외부 전용 인터넷 게이트웨이)                                   | IPv6 전용 인터넷 게이트웨이   |
| Gateway Load Balancer Endpoint (게이트웨이 로드밸런서 엔드포인트)                               | 로드벨런서 전용 엔트포인트      |
| Instance(인스턴스)                                                                   |                     |
| Local(로컬)                                                                        | VPC 전용 On-link 라우팅  |
| NAT Gateway(Natwork Address Transformation Gateway) [[인터넷 게이트웨이(IGW) 와 NAT Gateway]] | 인터넷 주소 변환 게이트웨이     |
| Network Interface (네트워크 인터페이스)                                                   | 네트워크 인터페이스          |
| Outpost Local Gateway (Outpost 로컬 게이트웨이)                                         | Outposts 연결용        |
| Peering Connection (피어링 연결)                                                      |                     |
| Transit Gateway                                                                  |                     |
| Virtual Private Gateway                                                          |                     |

